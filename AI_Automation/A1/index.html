<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MoodTune - Emotion-Based Music Player</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sentiment@5.0.2/sentiment.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }

      body {
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        color: #fff;
        min-height: 100vh;
        overflow: hidden;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      header {
        text-align: center;
        padding: 20px 0;
        z-index: 10;
      }

      h1 {
        font-size: 3.5rem;
        background: linear-gradient(45deg, #e94584, #0ff0fc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 10px;
        text-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      .tagline {
        font-size: 1.2rem;
        color: #a1a8c9;
        margin-bottom: 30px;
      }

      .main-content {
        display: flex;
        flex: 1;
        gap: 30px;
        z-index: 10;
      }

      .mood-selector {
        flex: 1;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        padding: 25px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      }

      .visualization {
        flex: 2;
        border-radius: 20px;
        overflow: hidden;
        position: relative;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      }

      .section-title {
        font-size: 1.5rem;
        margin-bottom: 20px;
        color: #6e88ff;
      }

      .mood-buttons {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        margin-bottom: 30px;
      }

      .mood-btn {
        padding: 15px;
        border: none;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
      }

      .mood-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }

      .mood-btn.happy {
        background: linear-gradient(45deg, #ff9a9e, #fad0c4);
        color: #333;
      }
      .mood-btn.sad {
        background: linear-gradient(45deg, #4facfe, #00f2fe);
      }
      .mood-btn.calm {
        background: linear-gradient(45deg, #6a11cb, #2575fc);
      }
      .mood-btn.energetic {
        background: linear-gradient(45deg, #f83600, #f9d423);
        color: #333;
      }
      .mood-btn.romantic {
        background: linear-gradient(45deg, #ff057c, #8d0b93);
      }
      .mood-btn.focused {
        background: linear-gradient(45deg, #0ba360, #3cba92);
      }

      .text-input {
        margin-top: 25px;
      }

      textarea {
        width: 100%;
        height: 120px;
        background: rgba(255, 255, 255, 0.07);
        border: none;
        border-radius: 12px;
        padding: 15px;
        color: #fff;
        font-size: 1rem;
        margin-bottom: 15px;
        resize: none;
      }

      textarea:focus {
        outline: 2px solid #6e88ff;
      }

      .analyze-btn {
        width: 100%;
        padding: 15px;
        border: none;
        border-radius: 12px;
        background: linear-gradient(45deg, #ff6b6b, #ff8e53);
        color: white;
        font-size: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .analyze-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
      }

      .player-controls {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        padding: 25px;
        margin-top: 30px;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        z-index: 10;
      }

      .song-info {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
      }

      .album-art {
        width: 80px;
        height: 80px;
        border-radius: 12px;
        background: linear-gradient(45deg, #8e2de2, #4a00e0);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
      }

      .song-details {
        flex: 1;
      }

      .song-title {
        font-size: 1.2rem;
        margin-bottom: 5px;
      }

      .mood-indicator {
        font-size: 0.9rem;
        color: #a1a8c9;
      }

      .progress-container {
        width: 100%;
        height: 6px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 3px;
        margin: 15px 0;
        cursor: pointer;
      }

      .progress-bar {
        height: 100%;
        width: 30%;
        background: linear-gradient(90deg, #6e88ff, #ff6b6b);
        border-radius: 3px;
        transition: width 0.1s linear;
      }

      .controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 20px;
      }

      .control-btn {
        background: none;
        border: none;
        color: #fff;
        font-size: 1.5rem;
        cursor: pointer;
        padding: 10px;
        transition: all 0.3s ease;
      }

      .control-btn:hover {
        color: #6e88ff;
        transform: scale(1.1);
      }

      .play-btn {
        background: linear-gradient(45deg, #6e88ff, #ff6b6b);
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.8rem;
        box-shadow: 0 5px 15px rgba(110, 136, 255, 0.4);
      }

      .visual-canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      .mood-display {
        position: absolute;
        bottom: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.5);
        padding: 10px 20px;
        border-radius: 20px;
        font-size: 1.2rem;
        z-index: 11;
      }

      .mood-text {
        color: #ff6b6b;
        font-weight: bold;
      }

      footer {
        text-align: center;
        padding: 20px 0;
        color: #a1a8c9;
        font-size: 0.9rem;
        z-index: 10;
      }

      @media (max-width: 900px) {
        .main-content {
          flex-direction: column;
        }

        h1 {
          font-size: 2.5rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>MoodTune</h1>
        <p class="tagline">Your emotion-based music experience</p>
      </header>

      <div class="main-content">
        <div class="mood-selector">
          <h2 class="section-title">Select Your Mood</h2>
          <div class="mood-buttons">
            <button class="mood-btn happy">üòä Happy</button>
            <button class="mood-btn sad">üò¢ Sad</button>
            <button class="mood-btn calm">üòå Calm</button>
            <button class="mood-btn energetic">‚ö° Energetic</button>
            <button class="mood-btn romantic">‚ù§Ô∏è Romantic</button>
            <button class="mood-btn focused">üéØ Focused</button>
          </div>

          <div class="text-input">
            <h2 class="section-title">Or Describe Your Mood</h2>
            <textarea placeholder="Type how you're feeling today..."></textarea>
            <button class="analyze-btn">Analyze My Text</button>
          </div>
        </div>

        <div class="visualization">
          <div id="visual-canvas" class="visual-canvas"></div>
          <div class="mood-display">
            Current Mood: <span class="mood-text">None</span>
          </div>
        </div>
      </div>

      <div class="player-controls">
        <div class="song-info">
          <div class="album-art">üéµ</div>
          <div class="song-details">
            <div class="song-title">Select a mood to start playing</div>
            <div class="mood-indicator">Mood: None</div>
          </div>
        </div>

        <div class="progress-container">
          <div class="progress-bar"></div>
        </div>

        <div class="controls">
          <button class="control-btn">üîÅ</button>
          <button class="control-btn">‚èÆ</button>
          <button class="play-btn control-btn">‚ñ∂</button>
          <button class="control-btn">‚è≠</button>
          <button class="control-btn">üîÄ</button>
        </div>
      </div>

      <footer>
        <p>MoodTune ¬© 2023 | Emotion-Based Music Player</p>
      </footer>
    </div>

    <script>
      // Mood to music mapping
      const moodMusic = {
        happy: {
          title: "Upbeat Pop",
          color: [255, 200, 100],
          energy: 0.8,
        },
        sad: {
          title: "Melancholic Melodies",
          color: [100, 150, 255],
          energy: 0.3,
        },
        calm: {
          title: "Ambient Relaxation",
          color: [100, 220, 200],
          energy: 0.4,
        },
        energetic: {
          title: "High Energy Dance",
          color: [255, 100, 100],
          energy: 0.9,
        },
        romantic: {
          title: "Romantic Instrumentals",
          color: [255, 100, 200],
          energy: 0.6,
        },
        focused: {
          title: "Deep Focus",
          color: [150, 200, 255],
          energy: 0.5,
        },
      };

      // Current state
      let currentMood = null;
      let isPlaying = false;

      // Initialize Tone.js
      const player = new Tone.Player().toDestination();
      const reverb = new Tone.Reverb(0.5).toDestination();
      const delay = new Tone.FeedbackDelay(0.2, 0.5).toDestination();
      const filter = new Tone.Filter(800, "lowpass").toDestination();

      // Connect effects chain
      player.connect(reverb);
      player.connect(delay);
      player.connect(filter);

      // Setup sentiment analyzer
      const sentiment = new Sentiment();

      // Setup p5.js canvas
      let canvas;
      function setup() {
        canvas = createCanvas(800, 500);
        canvas.parent("visual-canvas");
        colorMode(RGB);
      }

      function draw() {
        // Clear with a semi-transparent background for trailing effect
        background(26, 26, 46, 50);

        if (currentMood) {
          const moodData = moodMusic[currentMood];
          drawVisualization(moodData);
        } else {
          drawIdleVisualization();
        }
      }

      function drawVisualization(moodData) {
        // Create mood-specific visualization
        const [r, g, b] = moodData.color;
        const energy = moodData.energy;

        // Base particles
        for (let i = 0; i < 50 * energy; i++) {
          const size = random(2, 8 + 20 * energy);
          const x = random(width);
          const y = random(height);
          const alpha = random(100, 200);

          fill(r, g, b, alpha);
          noStroke();
          ellipse(x, y, size);
        }

        // Add energy lines for high energy moods
        if (energy > 0.7) {
          stroke(r, g, b, 100);
          strokeWeight(1);
          for (let i = 0; i < 20 * energy; i++) {
            const x1 = random(width);
            const y1 = random(height);
            const length = random(20, 100);
            line(x1, y1, x1 + length, y1 + random(-20, 20));
          }
        }

        // Add gentle waves for calm moods
        if (energy < 0.5) {
          noFill();
          stroke(r, g, b, 100);
          strokeWeight(2);
          for (let i = 0; i < 5; i++) {
            beginShape();
            for (let x = 0; x < width; x += 10) {
              const y = height / 2 + sin(x / 50 + frameCount / 50 + i) * 30;
              vertex(x, y);
            }
            endShape();
          }
        }
      }

      function drawIdleVisualization() {
        // Default visualization when no mood is selected
        background(26, 26, 46, 50);

        // Gentle pulsing circles
        const pulse = sin(frameCount / 30) * 10;
        for (let i = 0; i < 5; i++) {
          const alpha = 100 - i * 20;
          const size = 100 + i * 30 + pulse;
          noFill();
          stroke(110, 136, 255, alpha);
          strokeWeight(2);
          ellipse(width / 2, height / 2, size);
        }

        // Floating particles
        for (let i = 0; i < 20; i++) {
          const x = random(width);
          const y = random(height);
          const size = random(2, 5);
          const alpha = random(50, 150);
          fill(255, 255, 255, alpha);
          noStroke();
          ellipse(x, y, size);
        }
      }

      // Mood selection handlers
      document.querySelectorAll(".mood-btn").forEach((button) => {
        button.addEventListener("click", () => {
          const mood = button.classList[1];
          setMood(mood);
        });
      });

      // Text analysis handler
      document.querySelector(".analyze-btn").addEventListener("click", () => {
        const text = document.querySelector("textarea").value;
        if (text.trim()) {
          analyzeText(text);
        }
      });

      // Play button handler
      document.querySelector(".play-btn").addEventListener("click", () => {
        if (currentMood) {
          togglePlayback();
        } else {
          alert("Please select a mood first!");
        }
      });

      function setMood(mood) {
        currentMood = mood;
        const moodData = moodMusic[mood];

        // Update UI
        document.querySelector(".mood-text").textContent = mood;
        document.querySelector(".song-title").textContent = moodData.title;
        document.querySelector(".mood-indicator").textContent = `Mood: ${mood}`;

        // Change background gradient based on mood
        const [r, g, b] = moodData.color;
        document.body.style.background = `
                linear-gradient(135deg, 
                rgba(${r}, ${g}, ${b}, 0.2) 0%, 
                #16213e 100%)
            `;

        // Simulate loading a track for this mood
        simulateLoadTrack(mood);
      }

      function analyzeText(text) {
        const result = sentiment.analyze(text);
        let mood;

        if (result.score > 2) {
          mood = "happy";
        } else if (result.score > 0) {
          mood = "calm";
        } else if (result.score > -2) {
          mood = "focused";
        } else {
          mood = "sad";
        }

        setMood(mood);
      }

      function simulateLoadTrack(mood) {
        // In a real implementation, this would load an actual audio file
        console.log(`Loading track for mood: ${mood}`);

        // Update play button to show we're ready
        isPlaying = false;
        document.querySelector(".play-btn").textContent = "‚ñ∂";
      }

      function togglePlayback() {
        isPlaying = !isPlaying;

        if (isPlaying) {
          // In a real implementation, this would start playback
          document.querySelector(".play-btn").textContent = "‚è∏";
          console.log(`Playing ${currentMood} track`);

          // Start a simple playback progress simulation
          simulatePlayback();
        } else {
          document.querySelector(".play-btn").textContent = "‚ñ∂";
          console.log("Playback paused");
        }
      }

      function simulatePlayback() {
        // Simple progress bar animation for demo purposes
        let width = 0;
        const progressBar = document.querySelector(".progress-bar");
        const interval = setInterval(() => {
          if (!isPlaying) {
            clearInterval(interval);
            return;
          }

          width += 0.5;
          if (width > 100) width = 0;
          progressBar.style.width = `${width}%`;
        }, 100);
      }

      // Initialize p5 sketch
      new p5();
    </script>
  </body>
</html>
